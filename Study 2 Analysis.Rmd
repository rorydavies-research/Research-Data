---
title: ''
output: html_document
date: ''
---

---
title: ''
output: html_document
date: ''
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r dataprep, echo=FALSE, warning=FALSE, include=FALSE,message=FALSE}

#load packages
library(dplyr)
library(ggplot2)
library(gridExtra)
library(ggpubr)
library(tidyverse)
library(purrr)
library(Hmisc)
library(reshape2)
library(viridis)
library(ggridges)
library(gghalves)
library(readxl)
library(lubridate)
library(patchwork)

#import my data from CSV 
#PlayerMaker <- read.csv("PossessionSummaryDatabase.csv", header = TRUE, sep = ",", skip=6)
#CODEDPlayerMaker <- read.csv("AFL Kick Velocity Database CODED.csv", header = TRUE, sep = ",", skip=4)
#VFLCODEDPlayerMaker <- read.csv("VFL Kick Velocity Database CODED.csv", header = TRUE, sep = ",", skip=1)

#Import AFLW Dataset 2024
AFLWPlayerMaker <- read.csv("AFLW Kick Database 2024 CODED.csv", header = TRUE)

#Import VFLW Dataset 2024
VFLWPlayerMaker <- read.csv("VFLW Kick Database 2024 CODED.csv", header = TRUE)

#---------------

#Import AFLM Dataset 2024
AFLMPlayerMaker <- read.csv("AFL Kick Velocity Database CODED.csv", header = TRUE)

#Import VFLM Dataset 2024
VFLMPlayerMaker <- read.csv("VFL Kick Velocity Database CODED.csv", header = TRUE)

## PLayerMaker Kick Database - Filter relevant metrics & rename columns =
#PMData <- PlayerMaker %>% select(Session.Type, Date, Tag,`Player.Name`,`Releasing.Leg`,`Release.Velocity..m.sec.`)
#colnames(PMData) <- c("Session","Date", "Period", "Player","KLeg","KVelocity")

#AFL Coded Datafile
#AFLData <- CODEDPlayerMaker %>% select (X10.3.2023,Main.Training,Warm.Up.Kicking.2023.03.10,Start.Time,X.2,X.3,X.6,X.8,X.9,X.10)
#colnames(AFLData) <- c("Date","Session", "VideoLabel", "Player","VelBand","KickLeg", "KickType","KickVelocity","Detection","KickLabel")

#VFL Coded Datafile
#VFLData <- VFLCODEDPlayerMaker %>% select(VFL.Trial.15.06.23,Start.Time,X.3,X.4,X.7,X.9,X.10)
#colnames(VFLData) <- c("VideoLabel", "Player","VelBand","KickLeg", "KickType","KickVelocity","Detection")

```

```{css, echo = FALSE}
h1, h2, h3, h4, h5, h6, h7, h8, h9, h10, h11 {
text-align: center;
}

```


```{r,logo,echo = FALSE, out.width="100%", fig.align='right'}
# Loading the Western Bulldogs logo

knitr::include_graphics("wb_logo.png", error = FALSE)
```

<br>

### FEMALE GROUPS

```{r,AFLW, echo=FALSE, warning=FALSE, message=FALSE, out.width="70%",fig.align='center'}

# AFLW Kick Detction Counts

#--------------------------------------------------------------------------------------
#AFLW CODED ON VIDEO - Overall Detection Accuracy =

#Observed Kick Count
AFLWObserved <- AFLWPlayerMaker %>% filter(Observed.Not.Observed == "Observed")

# Detcted Kick Count
AFLWDetected <- AFLWPlayerMaker %>% filter(Detected.Not.Detected == "Detected")

# Not Detected Kick Count
AFLW_NotDetected <- AFLWPlayerMaker %>% filter(Detected.Not.Detected == "Not Detected")

# Summary Table of Counts
AFLDetected <- AFLWPlayerMaker %>% filter(Detected.Not.Detected == "Detected") %>% count() 
AFLNotDetected <- AFLWPlayerMaker %>% filter(Detected.Not.Detected == "Not Detected") %>% count()
colnames(AFLDetected)[colnames(AFLDetected) == "n"] = "Detected"
colnames(AFLNotDetected)[colnames(AFLNotDetected) == "n"] = "Not-Detected"
Detections <- merge(AFLDetected, AFLNotDetected, all=TRUE)
DetectionTotal <- Detections %>% mutate("TOTAL KICKS" = (`Detected`+ `Not-Detected`))
DetectionRate <- DetectionTotal %>% mutate("Detection Accuracy %" = (`Detected`/`TOTAL KICKS`)) %>% mutate("Error Rate %" = (`Not-Detected`/`TOTAL KICKS`))


# ----------
# Count Kick Types - AFLW

#Filter dataset to remove unnessccary columns
AFLW_Filtered <- AFLWPlayerMaker %>% select(1,13,15:18)

#Count each Kick Type Observed 
AFLWKickTypes <- AFLW_Filtered %>% group_by(Kick.Type, Detected.Not.Detected, Kick.Category, Observed.Not.Observed) %>%
  summarise(Count = n())


###--------------
# Plotting Kick Type Velocity Profiles AFLW

#Remove 'No Kick'
AFLW_Velocity <- AFLW_Filtered %>% filter(Kick.Category != "No Kick")

# First create a summary table with Mean, Median, Min and Max velocity for each kick type
Velocity_summary_table <- AFLW_Velocity %>%
  group_by(Kick.Category) %>%
  summarise(
    Mean = mean(Release.Velocity.m.s, na.rm = TRUE),
    Median = median(Release.Velocity.m.s, na.rm = TRUE),
    Min = min(Release.Velocity.m.s, na.rm = TRUE),
    Max = max(Release.Velocity.m.s, na.rm = TRUE),
    Std_Dev = sd(Release.Velocity.m.s, na.rm = TRUE))

#totals for MEAN
# Calculate the mean and standard deviation of the Mean column
mean_of_means <- mean(Velocity_summary_table$Mean, na.rm = TRUE)
sd_of_means <- sd(Velocity_summary_table$Mean, na.rm = TRUE)


AFLW_plot1 <- ggplot(AFLW_Velocity, aes(x = Kick.Category, y = Release.Velocity.m.s)) +
  geom_boxplot(fill = "white", color = "black", alpha = 0.5) +  # Plain white boxplots
  geom_jitter(aes(color = Kick.Category), width = 0.3, size = 1, alpha = 1) +  # Scatter plot points
  labs(title = "Phase One - Female Group (AFLW)", y = "Velocity (m.s)", x = NULL) +  # Remove x-axis label
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(angle = 40, hjust = 1),
        legend.position = "none") +  # Remove the legend
  scale_y_continuous(limits = c(5, 25)) +  # Adjust y-axis for velocity range
  scale_x_discrete(limits = c("Other Kick", "Grubber Kick", "Checkside Kick", 
                              "Surge Kick", "Punch Kick", "Weighted Kick", 
                              "Set Shot at Goal", "Snap Kick"))  # Reorder x-axis labels

# Print the plot
AFLW_plot1


```

<br>

```{r,VFLW, echo=FALSE, warning=FALSE, message=FALSE, out.width="70%",fig.align='center'}

# VFLW Kick Detction Counts

#--------------------------------------------------------------------------------------
#VFLW CODED ON VIDEO - Overall Detection Accuracy =

# Remove Other Kicks - not required or relevant for VFLW Phase Two
VFLWPlayerMaker <- VFLWPlayerMaker %>% filter(Kick.Category != "Other Kick")

#Observed Kick Count
VFLWObserved <- VFLWPlayerMaker %>% filter(Observed.Not.Observed == "Observed")

# Detcted Kick Count
VFLWDetected <- VFLWPlayerMaker %>% filter(Detected.Not.Detected == "Detected")

# Not Detected Kick Count
VFLW_NotDetected <- VFLWPlayerMaker %>% filter(Detected.Not.Detected == "Not Detected")

# Summary Table of Counts
VFLWDetected <- VFLWPlayerMaker %>% filter(Detected.Not.Detected == "Detected") %>% count() 
VFLWNotDetected <- VFLWPlayerMaker %>% filter(Detected.Not.Detected == "Not Detected") %>% count()
colnames(VFLWDetected)[colnames(VFLWDetected) == "n"] = "Detected"
colnames(VFLWNotDetected)[colnames(VFLWNotDetected) == "n"] = "Not-Detected"
VFLWDetections <- merge(VFLWDetected, VFLWNotDetected, all=TRUE)
VFLWDetectionTotal <- VFLWDetections %>% mutate("TOTAL KICKS" = (`Detected`+ `Not-Detected`))
VFLWDetectionRate <- VFLWDetectionTotal %>% mutate("Detection Accuracy %" = (`Detected`/`TOTAL KICKS`)) %>% mutate("Error Rate %" = (`Not-Detected`/`TOTAL KICKS`))


# ----------
# Count Kick Types - AFLW

#Filter dataset to remove unnessccary columns
VFLW_Filtered <- VFLWPlayerMaker %>% select(1,12,14:17)

#Count each Kick Type Observed 
VFLWKickTypes <- VFLW_Filtered %>% group_by(Kick.Type, Detected.Not.Detected, Kick.Category, Observed.Not.Observed) %>%
  summarise(Count = n())


###--------------
# Plotting Kick Type Velocity Profiles AFLW

#Remove 'No Kick'
VFLW_Velocity <- VFLW_Filtered %>% filter(Kick.Category != "No Kick")

# First create a summary table with Mean, Median, Min and Max velocity for each kick type
VFLW_Velocity_summary_table <- VFLW_Velocity %>%
  group_by(Kick.Category) %>%
  summarise(
    Mean = mean(Kick.Velocity.m.s, na.rm = TRUE),
    Median = median(Kick.Velocity.m.s, na.rm = TRUE),
    Min = min(Kick.Velocity.m.s, na.rm = TRUE),
    Max = max(Kick.Velocity.m.s, na.rm = TRUE),
    Std_Dev = sd(Kick.Velocity.m.s, na.rm = TRUE))

#totals for MEAN
# Calculate the mean and standard deviation of the Mean column
VFLW_mean_of_means <- mean(VFLW_Velocity_summary_table$Mean, na.rm = TRUE)
VFLW_sd_of_means <- sd(VFLW_Velocity_summary_table$Mean, na.rm = TRUE)


VFLW_plot1 <- ggplot(VFLW_Velocity, aes(x = Kick.Category, y = Kick.Velocity.m.s)) +
  geom_boxplot(fill = "white", color = "black", alpha = 0.5) +  # Plain white boxplots
  geom_jitter(aes(color = Kick.Category), width = 0.3, size = 1, alpha = 1) +  # Scatter plot points
  labs(title = "Phase Two - Female Group (VFLW)", y = "Velocity (m.s)", x = NULL) +  # Remove x-axis label
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(angle = 40, hjust = 1),
        legend.position = "none") +  # Remove the legend
  scale_y_continuous(limits = c(5, 20)) +  # Adjust y-axis for velocity range
  scale_x_discrete(limits = c("Kick to Self", "Grubber 15m", "Drop Punt 15m", "Snap Kick 15m", "Grubber 30m", "Grubber 50m", "Drop Punt 30m", "Snap Kick 30m",
                              "Surge Kick", "Torpedo Kick", "Snap Kick 50m", "Drop Punt 50m"))  # Reorder x-axis labels

# Print the plot
VFLW_plot1


```


<br><br<br>




### MALE GROUPS BELOW

```{r,AFLM, echo=FALSE, warning=FALSE, message=FALSE, out.width="70%",fig.align='center'}

# AFL-M Kick Detction Counts

#--------------------------------------------------------------------------------------
#AFL CODED ON VIDEO - Overall Detection Accuracy =

#Observed Kick Count
AFLMObserved <- AFLMPlayerMaker %>% filter(Observed.Not.Observed == "Observed")

# Detcted Kick Count
AFLMDetected <- AFLMPlayerMaker %>% filter(Detected.Not.Detected == "Detected")

# Not Detected Kick Count
AFLM_NotDetected <- AFLMPlayerMaker %>% filter(Detected.Not.Detected == "Not Detected")

# Summary Table of Counts
AFLMDetected <- AFLMPlayerMaker %>% filter(Detected.Not.Detected == "Detected") %>% count() 
AFLMNotDetected <- AFLMPlayerMaker %>% filter(Detected.Not.Detected == "Not Detected") %>% count()
colnames(AFLMDetected)[colnames(AFLMDetected) == "n"] = "Detected"
colnames(AFLMNotDetected)[colnames(AFLMNotDetected) == "n"] = "Not-Detected"
AFLMDetections <- merge(AFLMDetected, AFLMNotDetected, all=TRUE)
AFLMDetectionTotal <- AFLMDetections %>% mutate("TOTAL KICKS" = (`Detected`+ `Not-Detected`))
AFLMDetectionRate <- AFLMDetectionTotal %>% mutate("Detection Accuracy %" = (`Detected`/`TOTAL KICKS`)) %>% mutate("Error Rate %" = (`Not-Detected`/`TOTAL KICKS`))


# ----------
# Count Kick Types - AFLW

#Filter dataset to remove unnessccary columns
AFLM_Filtered <- AFLMPlayerMaker %>% select(1,13,15:18)

#Count each Kick Type Observed 
AFLMKickTypes <- AFLM_Filtered %>% group_by(Kick.Type, Detected.Not.Detected, Kick.Category, Observed.Not.Observed) %>%
  summarise(Count = n())


###--------------
# Plotting Kick Type Velocity Profiles AFLW

#Re
AFLM_Velocity <- AFLM_Filtered 

# First create a summary table with Mean, Median, Min and Max velocity for each kick type
AFLMVelocity_summary_table <- AFLM_Velocity %>%
  group_by(Kick.Category) %>%
  summarise(
    Mean = mean(Release.Velocity.m.s, na.rm = TRUE),
    Median = median(Release.Velocity.m.s, na.rm = TRUE),
    Min = min(Release.Velocity.m.s, na.rm = TRUE),
    Max = max(Release.Velocity.m.s, na.rm = TRUE),
    Std_Dev = sd(Release.Velocity.m.s, na.rm = TRUE))

#totals for MEAN
# Calculate the mean and standard deviation of the Mean column
AFLMmean_of_means <- mean(AFLMVelocity_summary_table$Mean, na.rm = TRUE)
AFLMsd_of_means <- sd(AFLMVelocity_summary_table$Mean, na.rm = TRUE)


AFLM_plot1 <- ggplot(AFLM_Velocity, aes(x = Kick.Category, y = Release.Velocity.m.s)) +
  geom_boxplot(fill = "white", color = "black", alpha = 0.5) +  # Plain white boxplots
  geom_jitter(aes(color = Kick.Category), width = 0.3, size = 1, alpha = 1) +  # Scatter plot points
  labs(title = "Phase One - Male Group (AFL)", y = "Velocity (m.s)", x = NULL) +  # Remove x-axis label
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(angle = 40, hjust = 1),
        legend.position = "none") +  # Remove the legend
  scale_y_continuous(limits = c(5, 25)) +  # Adjust y-axis for velocity range
  scale_x_discrete(limits = c("Grubber Kick", "Checkside Kick", "Other Kick", 
                              "Weighted Kick", "Punch Kick", "Snap Kick", 
                              "Surge Kick", "Torpedo Kick", "Set Shot at Goal"))  # Reorder x-axis labels

# Print the plot
AFLM_plot1


```

<br>

```{r,VFLM, echo=FALSE, warning=FALSE, message=FALSE, out.width="70%",fig.align='center'}

# VFL-M Kick Detction Counts

#--------------------------------------------------------------------------------------
#VFL CODED ON VIDEO - Overall Detection Accuracy =

#Observed Kick Count
VFLMObserved <- VFLMPlayerMaker %>% filter(Observed.Not.Observed == "Observed")

# Detcted Kick Count
VFLMDetected <- VFLMPlayerMaker %>% filter(Detected.Not.Detected == "Detected")

# Not Detected Kick Count
VFLM_NotDetected <- VFLMPlayerMaker %>% filter(Detected.Not.Detected == "Not Detected")

# Summary Table of Counts
VFLMDetected <- VFLMPlayerMaker %>% filter(Detected.Not.Detected == "Detected") %>% count() 
VFLMNotDetected <- VFLMPlayerMaker %>% filter(Detected.Not.Detected == "Not Detected") %>% count()
colnames(VFLMDetected)[colnames(VFLMDetected) == "n"] = "Detected"
colnames(VFLMNotDetected)[colnames(VFLMNotDetected) == "n"] = "Not-Detected"
VFLMDetections <- merge(VFLMDetected, VFLMNotDetected, all=TRUE)
VFLMDetectionTotal <- VFLMDetections %>% mutate("TOTAL KICKS" = (`Detected`+ `Not-Detected`))
VFLMDetectionRate <- VFLMDetectionTotal %>% mutate("Detection Accuracy %" = (`Detected`/`TOTAL KICKS`)) %>% mutate("Error Rate %" = (`Not-Detected`/`TOTAL KICKS`))


# ----------
# Count Kick Types - AFLW

#Filter dataset to remove unnessccary columns
VFLM_Filtered <- VFLMPlayerMaker %>% select(1,12,14:17)

#Count each Kick Type Observed 
VFLMKickTypes <- VFLM_Filtered %>% group_by(Kick.Type, Detected.Not.Detected, Kick.Category, Observed.Not.Observed) %>%
  summarise(Count = n())


###--------------
# Plotting Kick Type Velocity Profiles AFLW

#Re
VFLM_Velocity <- VFLM_Filtered 

# First create a summary table with Mean, Median, Min and Max velocity for each kick type
VFLMVelocity_summary_table <- VFLM_Velocity %>%
  group_by(Kick.Category) %>%
  summarise(
    Mean = mean(Kick.Velocity.m.s, na.rm = TRUE),
    Median = median(Kick.Velocity.m.s, na.rm = TRUE),
    Min = min(Kick.Velocity.m.s, na.rm = TRUE),
    Max = max(Kick.Velocity.m.s, na.rm = TRUE),
    Std_Dev = sd(Kick.Velocity.m.s, na.rm = TRUE))

#totals for MEAN
# Calculate the mean and standard deviation of the Mean column
VFLMmean_of_means <- mean(VFLMVelocity_summary_table$Mean, na.rm = TRUE)
VFLMsd_of_means <- sd(VFLMVelocity_summary_table$Mean, na.rm = TRUE)


VFLM_plot1 <- ggplot(VFLM_Velocity, aes(x = Kick.Category, y = Kick.Velocity.m.s)) +
  geom_boxplot(fill = "white", color = "black", alpha = 0.5) +  # Plain white boxplots
  geom_jitter(aes(color = Kick.Category), width = 0.3, size = 1, alpha = 1) +  # Scatter plot points
  labs(title = "Phase Two - Male Group (VFL)", y = "Velocity (m.s)", x = NULL) +  # Remove x-axis label
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(angle = 40, hjust = 1),
        legend.position = "none") +  # Remove the legend
  scale_y_continuous(limits = c(5, 25)) +  # Adjust y-axis for velocity range
  scale_x_discrete(limits = c("Grubber 15m", "Snap Kick 15m", "Drop Punt 15m", "Grubber 30m", "Drop Punt 30m", "Snap Kick 30m", "Grubber 50m", "Surge Kick", "Torpedo Kick", "Snap Kick 50m", "Drop Punt 50m"))  # Reorder x-axis labels

# Print the plot
VFLM_plot1


```




### ALL GROUPS - DATABASE

# PHASE ONE (BOTH)

```{r, echo=FALSE,fig.height=7, out.width="80%"}

#Import DATABASE 2024
Study2_Database <- read.csv("Study 2 - DATABASE/Study 2 Kick Database.csv", header = TRUE)

#Remove 'No Kick'
Study2_Velocity <- Study2_Database %>% filter(Kick.Category != "No Kick")

### PHASE ONE FIRST
PHASE_ONE <- Study2_Velocity %>% filter(grepl("Phase One", Phase))




# Plot and Use facet_wrap
PHASE_ONE_plot <- ggplot(PHASE_ONE, aes(x = Kick.Category, y = Release.Velocity.m.s)) +
  geom_boxplot(fill = "white", color = "black", alpha = 0.5) +  # Plain white boxplots
  geom_jitter(aes(color = Kick.Category), width = 0.3, size = 0.5, alpha = 1) +  # Scatter plot points
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 16),  # Modify the main plot title
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(angle = 40, hjust = 1),
        legend.position = "none",  # Remove the legend
        strip.text = element_text(face = "bold", size = 12, hjust = 0.5),  # Modify facet titles
        axis.title.x = element_blank()) +  # Remove x-axis title
  scale_y_continuous(limits = c(5, 25)) + 
  facet_wrap(~Phase, ncol = 1, labeller = labeller(Phase = c("Phase One - AFL" = "A) On-Field Phase - Male Group (AFL)", 
                                                           "Phase One - AFLW" = "B) On-Field Phase - Female Group (AFLW)"))) +  # Customize facet titles
  scale_x_discrete(limits = c("Grubber Kick", "Checkside Kick","Other Kick",
                              "Weighted Kick", "Punch Kick", "Surge Kick", 
                              "Snap Kick", "Torpedo Kick", "Set Shot at Goal")) +  # Reorder x-axis labels
  labs(y = expression("Velocity (m.s"^-1*")"))  # Correct y-axis label using expression





# Print the plot
PHASE_ONE_plot




```



# PHASE TWO (BOTH)

```{r, echo=FALSE,fig.height=7, out.width="80%"}

### PHASE ONE FIRST
PHASE_TWO <- Study2_Velocity %>% filter(grepl("Phase Two", Phase))

#Remove 'Other'
PHASE_TWO <- PHASE_TWO %>% filter(Kick.Category != "Other Kick")

# Plot and Use facet_wrap
PHASE_TWO_plot <- ggplot(PHASE_TWO, aes(x = Kick.Category, y = Release.Velocity.m.s)) +
  geom_boxplot(fill = "white", color = "black", alpha = 0.5) +  # Plain white boxplots
  geom_jitter(aes(color = Kick.Category), width = 0.3, size = 0.5, alpha = 1) +  # Scatter plot points
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 16),  # Modify the main plot title
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_text(angle = 40, hjust = 1),
        legend.position = "none",  # Remove the legend
        strip.text = element_text(face = "bold", size = 12, hjust = 0.5),  # Modify facet titles
        axis.title.x = element_blank()) +  # Remove x-axis title
  scale_y_continuous(limits = c(5, 25)) + 
  facet_wrap(~Phase, ncol = 1, labeller = labeller(Phase = c("Phase Two - VFL" = "A) Protocol Phase - Male Group (VFL)", 
                                                           "Phase Two - VFLW" = "B) Protocol Phase - Female Group (VFLW)"))) +  # Customize facet titles
  scale_x_discrete(limits = c("Kick to Self", "Grubber 15m", "Snap Kick 15m", "Drop Punt 15m", "Grubber 30m", "Snap Kick 30m", "Drop Punt 30m", "Grubber 50m", "Snap Kick 50m", "Drop Punt 50m", "Surge Kick","Torpedo Kick")) +  # Reorder x-axis labels
  labs(y = expression("Velocity (m.s"^-1*")"))  # Correct y-axis label using expression


# Print the plot
PHASE_TWO_plot






```




